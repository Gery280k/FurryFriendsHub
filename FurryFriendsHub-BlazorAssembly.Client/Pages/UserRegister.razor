@page "/userRegister"
@inject IUserService UserService

<h3>Crear Cuenta</h3>

<EditForm Model="@newUser" OnValidSubmit="InsertUsuario">
	<DataAnnotationsValidator /> 
	<ValidationSummary class="text-danger" />

	<div class="mb-3">
		<label for="username" class="form-label">Usuario: </label>
		<InputText  id="username" class="form-control" @bind-Value="newUser.username" />
	</div>

	<div class="mb-3">
		<label for="email" class="form-label">Correo electrónico: </label>
		<InputText id="email" class="form-control" @bind-Value="newUser.email"/>
	</div>

	<div class="mb-3">
		<label for="password" class="form-label">Contraseña: </label>
		<InputText  id="password" class="form-control" @bind-Value="newUser.passwordHash"/>
	</div>
	
	<input type="submit" class="btn btn-primary" value="Registrar" />

</EditForm>

@if(isInserted == true)
{
	<div class="alert alert-success mt-3" >Registro Exitoso</div>
}

@code {

	private User newUser = new User();
	private bool isInserted = false;

	protected async Task InsertUsuario()
	{
		try
		{
			await UserService.SaveUser(newUser);
			isInserted = true;
		}
		catch(Exception ex)
		{
			Console.WriteLine($"Error al guardar usuario: {ex.Message}");
			isInserted = false;
		}

	}
}
